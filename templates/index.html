{% extends "base.html" %}

{% block content %}
<div class="container py-5">
    <!-- Hero Section -->
    <div class="row justify-content-center text-center mb-5">
        <div class="col-lg-8">
            <div class="mb-4">
                <i class="fas fa-robot fa-4x text-primary mb-3"></i>
                <h1 class="display-4 fw-bold mb-3">DocRag</h1>
                <p class="lead">AI-powered technical documentation assistant that helps developers find answers from React, Python, and FastAPI documentation using natural language queries.</p>
            </div>
            
            <div class="d-grid gap-2 d-md-flex justify-content-md-center">
                <a href="{{ url_for('main.chat') }}" class="btn btn-primary btn-lg px-4">
                    <i class="fas fa-comments me-2"></i>Start Chatting
                </a>
                <button type="button" class="btn btn-outline-secondary btn-lg px-4" data-bs-toggle="modal" data-bs-target="#featuresModal">
                    <i class="fas fa-info-circle me-2"></i>Learn More
                </button>
            </div>
        </div>
    </div>

    <!-- Features Grid -->
    <div class="row g-4 mb-5">
        <div class="col-md-4">
            <div class="card h-100 bg-dark border-secondary">
                <div class="card-body text-center">
                    <i class="fas fa-search fa-3x text-primary mb-3"></i>
                    <h5 class="card-title">Semantic Search</h5>
                    <p class="card-text">Find relevant information across multiple documentation sources using natural language queries.</p>
                </div>
            </div>
        </div>
        
        <div class="col-md-4">
            <div class="card h-100 bg-dark border-secondary">
                <div class="card-body text-center">
                    <i class="fas fa-code fa-3x text-success mb-3"></i>
                    <h5 class="card-title">Code Generation</h5>
                    <p class="card-text">Get functional code examples with syntax highlighting and step-by-step explanations.</p>
                </div>
            </div>
        </div>
        
        <div class="col-md-4">
            <div class="card h-100 bg-dark border-secondary">
                <div class="card-body text-center">
                    <i class="fas fa-link fa-3x text-info mb-3"></i>
                    <h5 class="card-title">Source Citations</h5>
                    <p class="card-text">Every answer includes direct links to official documentation sources for verification.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Documentation Sources -->
    <div class="row justify-content-center">
        <div class="col-lg-10">
            <h3 class="text-center mb-4">
                <i class="fas fa-books me-2"></i>Supported Documentation
            </h3>
            
            <div class="row g-3">
                <div class="col-md-4">
                    <div class="card bg-dark border-secondary">
                        <div class="card-body text-center">
                            <i class="fab fa-react fa-2x text-info mb-2"></i>
                            <h6 class="card-title">React</h6>
                            <p class="card-text small">Components, Hooks, State Management</p>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-4">
                    <div class="card bg-dark border-secondary">
                        <div class="card-body text-center">
                            <i class="fab fa-python fa-2x text-warning mb-2"></i>
                            <h6 class="card-title">Python</h6>
                            <p class="card-text small">Functions, Data Structures, Error Handling</p>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-4">
                    <div class="card bg-dark border-secondary">
                        <div class="card-body text-center">
                            <i class="fas fa-lightning-bolt fa-2x text-success mb-2"></i>
                            <h6 class="card-title">FastAPI</h6>
                            <p class="card-text small">REST APIs, Authentication, Models</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- System Status -->
    <div class="row justify-content-center mt-5">
        <div class="col-lg-8">
            <div class="card bg-dark border-secondary">
                <div class="card-header">
                    <h6 class="mb-0">
                        <i class="fas fa-server me-2"></i>System Status
                    </h6>
                </div>
                <div class="card-body">
                    <div id="system-status" class="text-center">
                        <div class="spinner-border spinner-border-sm text-primary me-2" role="status"></div>
                        Loading system status...
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Features Modal -->
<div class="modal fade" id="featuresModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content bg-dark">
            <div class="modal-header border-secondary">
                <h5 class="modal-title">
                    <i class="fas fa-info-circle me-2"></i>DocRag Features
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="row g-3">
                    <div class="col-12">
                        <h6><i class="fas fa-bolt text-primary me-2"></i>Fast & Accurate</h6>
                        <p class="small">Get answers in under 10 seconds with 85%+ accuracy rate from official documentation sources.</p>
                    </div>
                    
                    <div class="col-12">
                        <h6><i class="fas fa-comments text-success me-2"></i>Conversational</h6>
                        <p class="small">Multi-turn conversations with context awareness and conversation history.</p>
                    </div>
                    
                    <div class="col-12">
                        <h6><i class="fas fa-copy text-info me-2"></i>Copy-Friendly</h6>
                        <p class="small">All code examples include copy-to-clipboard functionality for easy use.</p>
                    </div>
                    
                    <div class="col-12">
                        <h6><i class="fas fa-shield-alt text-warning me-2"></i>Rate Limited</h6>
                        <p class="small">Built-in rate limiting (10 queries per minute) ensures fair usage and system stability.</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer border-secondary">
                <a href="{{ url_for('main.chat') }}" class="btn btn-primary">
                    <i class="fas fa-rocket me-2"></i>Try It Now
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Load system status
    loadSystemStatus();
    
    // Auto-refresh status every 30 seconds
    setInterval(loadSystemStatus, 30000);
});

async function loadSystemStatus() {
    try {
        const response = await fetch('/api/stats');
        const data = await response.json();
        
        const statusDiv = document.getElementById('system-status');
        
        if (response.ok) {
            statusDiv.innerHTML = `
                <div class="row text-center">
                    <div class="col-md-3">
                        <small class="text-muted">Documents</small>
                        <div class="fw-bold text-success">${data.documents.document_count}</div>
                    </div>
                    <div class="col-md-3">
                        <small class="text-muted">Conversations</small>
                        <div class="fw-bold text-info">${data.conversations.total}</div>
                    </div>
                    <div class="col-md-3">
                        <small class="text-muted">Avg Response</small>
                        <div class="fw-bold text-warning">${data.conversations.avg_response_time}s</div>
                    </div>
                    <div class="col-md-3">
                        <small class="text-muted">Cache Entries</small>
                        <div class="fw-bold text-primary">${data.cache.active_entries || 0}</div>
                    </div>
                </div>
            `;
        } else {
            statusDiv.innerHTML = `
                <div class="text-warning">
                    <i class="fas fa-exclamation-triangle me-2"></i>
                    Unable to load system status
                </div>
            `;
        }
    } catch (error) {
        console.error('Error loading system status:', error);
        document.getElementById('system-status').innerHTML = `
            <div class="text-danger">
                <i class="fas fa-times-circle me-2"></i>
                Error loading system status
            </div>
        `;
    }
}
</script>
{% endblock %}
